<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Mondrian architecture | BurningBright</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Mondrian architecture</h1><a id="logo" href="/.">BurningBright</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Mondrian architecture</h1><div class="post-meta">May 24, 2018<span> | </span><span class="category"><a href="/categories/db/">db</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><h2 id="Mondrian系统的图层"><a href="#Mondrian系统的图层" class="headerlink" title="Mondrian系统的图层"></a>Mondrian系统的图层</h2><p>OLAP: OnlineAnalytical Processing<br>Mondrian OLAP系统由四层组成; 从最终用户的眼睛到数据中心的核心，有如下：表示层，维度层，星层和存储层。</p>
<p>表示层决定最终用户在他或她的监视器上看到的内容，以及他或她如何交互以提出新问题。有多种方式可以呈现多维数据集，<br>包括数据透视表（上面显示的表格的交互式版本），饼图，线条和条形图以及高级可视化工具，如可点击的地图和动态图形。<br>这些可以用Swing或JSP编写，以JPEG或GIF格式呈现的图表或通过XML传输到远程应用程序。所有这些表示形式的共同之处在于<br>表示层提出问题的维度，度量和单元的多维“语法”，并且OLAP服务器返回答案。</p>
<p>第二层是维度层。维度层解析，验证并执行MDX查询。查询分多个阶段进行评估。首先计算坐标轴，然后计算坐标轴内单元格的值。<br>为了提高效率，维度层将批量请求发送给汇聚层。查询转换器允许应用程序操纵现有查询，而不是从头开始为每个请求构建MDX语句。<br>元数据描述了维度模型，以及它如何映射到关系模型。</p>
<p>第三层是星级层，负责维护聚合缓存。聚合是内存中的一组度量值’单元’[cells]，由一组维度列值限定。维度层发送单元组请求。<br>如果请求的单元格不在高速缓存中，或者通过在高速缓存中汇总聚合进行派生，则聚合管理器会向存储层发送请求。</p>
<p>存储层是一个RDBMS。它负责提供聚合的单元格数据，以及维度表中的成员。<br>我在下面描述为什么我决定使用RDBMS的功能，而不是开发针对多维数据优化的存储系统。</p>
<p>这些组件可以全部存在于同一台机器上，也可以分布在机器之间。构成Mondrian服务器的第2层和第3层必须位于同一台计算机上。<br>存储层可以在另一台机器上，通过远程JDBC连接访问。在多用户系统中，表示层将存在于每个最终用户的机器上（除了在服务器上生成的JSP页面的情况）。</p>
<p><img src="/2018/05/24/Mondrian-architecture/arch_mondrian_v1_lrg.png" alt=""><br><img src="/2018/05/24/Mondrian-architecture/architecture2_big.png" alt=""></p>
<h2 id="存储和聚合策略"><a href="#存储和聚合策略" class="headerlink" title="存储和聚合策略"></a>存储和聚合策略</h2><p>OLAP服务器通常根据其存储数据的方式进行分类：</p>
<ul>
<li>MOLAP（multidimensional  OLAP）服务器将其所有数据存储在磁盘中，并针对多维访问进行优化。<br>通常，数据以密集阵列存储，每个单元值只需要4或8个字节。</li>
<li>ROLAP（relational OLAP）服务器将其数据存储在关系数据库中。事实表中的每一行都有一个用于每个维度和度量的列。<br>需要存储三种数据：事实表数据（事务记录），聚合和维度。</li>
</ul>
<p>MOLAP数据库以多维格式存储事实数据，但如果维度不止一个维度，则这些数据将会很稀疏，并且多维格式表现不佳。<br>HOLAP（混合OLAP）系统通过在关系数据库中保留最细粒度的数据来解决此问题，但将聚合以多维格式存储。</p>
<p>预先计算的聚合对于大型数据集是必需的，否则某些查询在未读取事实表的全部内容的情况下不能被回答。<br>MOLAP聚合通常是内存数据结构的图像，分解成页面并存储在磁盘上。ROLAP聚合被存储在表中。<br>在一些ROLAP系统中，这些由OLAP服务器显式管理; 在其他系统中，这些表被声明为物化视图[materialized views]，<br>并且当OLAP服务器使用 group by子句中列的正确组合发出查询时，它们将被隐式使用。</p>
<p>聚合策略的最后组件是缓存。高速缓存将预先计算的聚合保存在内存中，以便后续查询可以访问单元值而不必访问磁盘。<br>如果缓存将所需数据集保留在较低级别的聚合中，则它可以通过<strong>卷起来</strong>计算所需的数据集。</p>
<p>缓存可以说是聚合策略中最重要的部分，因为它是自适应的。很难选择一组聚合来预先计算在不使用大量磁盘的情况下加速系统的速度，<br>特别是那些维度较高或用户提交不可预知查询的系统。在数据实时变化的系统中，维护预先计算的聚合是不切实际的。<br>合理大小的缓存可以允许系统在面对不可预知的查询时充分执行，而预先计算的聚合很少或没有。</p>
<p><code>蒙德里安</code>的汇总策略如下：</p>
<ul>
<li>事实数据存储在RDBMS中。RDBMS已经有一个存储管理器，为什么还要开发一个？</li>
<li>通过查询提交分组，将聚合数据读入缓存。同样，RDBMS有一个聚合器，为什么还要开发一个？</li>
<li>如果RDBMS支持实体化视图，并且数据库管理员选择为特定聚合创建实体化视图，则Mondrian将隐式使用它们。<br>理想情况下，<code>蒙德里安</code>的聚合管理者应该意识到存在这些物化视图，并且这些特定的聚合计算起来很便宜。<br>它甚至应该向数据库管理员提供调优建议。</li>
</ul>
<p>总体思路是将数据库的内容委托给数据库。<br>这给数据库带来了额外的负担，但是一旦将这些功能添加到数据库中，数据库的所有客户端都将从中受益。<br>多维存储可以减少I / O，并在某些情况下可以加快操作速度，但我认为这不足以保证现阶段的复杂性。</p>
<p>一个奇妙的副作用是因为Mondrian自己不需要存储空间，所以可以通过将JAR文件添加到类路径中并立即启动并运行来安装它。<br>由于没有冗余数据集进行管理，数据加载过程更容易，<strong>Mondrian非常适合在实时更改的数据集上执行OLAP。</strong></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p>Mondrian为客户端应用程序提供执行查询的API。</p>
<p>由于没有普遍接受的用于执行OLAP查询的API，Mondrian的主要API是专有的; 然而，任何使用过JDBC的人都会发现它很熟悉。<br>主要区别在于查询语言：Mondrian使用称为MDX的语言(M ulti- D dimension e X pressions)来指定查询，其中JDBC将使用SQL。<br>下面更详细地描述MDX。</p>
<p>连接 经由创建 的DriverManager，以类似的方式来JDBC。<br>一个 查询是类似于JDBC 声明，并且通过解析MDX字符串创建。<br>甲 结果是类似于JDBC 结果集 ; 因为我们正在处理多维数据，所以它由轴和单元组成，而不是行和列。<br>由于OLAP旨在用于数据挖掘，因此可以通过 drillDown和 sort等操作修改查询中包含的分析树 ，然后重新执行查询。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mondrian.olap.*;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line">Connection connection = DriverManager.getConnection(</span><br><span class="line">    <span class="string">"Provider=mondrian;"</span> +</span><br><span class="line">    <span class="string">"Jdbc=jdbc:odbc:MondrianFoodMart;"</span> +</span><br><span class="line">    <span class="string">"Catalog=/WEB-INF/FoodMart.xml;"</span>,</span><br><span class="line">    <span class="keyword">null</span>,</span><br><span class="line">    <span class="keyword">false</span>);</span><br><span class="line">Query query = connection.parseQuery(</span><br><span class="line">    <span class="string">"SELECT &#123;[Measures].[Unit Sales], [Measures].[Store Sales]&#125; on columns,"</span> +</span><br><span class="line">    <span class="string">"&#123;[Product].children&#125; on rows "</span> +</span><br><span class="line">    <span class="string">"FROM [Sales] "</span> +</span><br><span class="line">    <span class="string">"WHERE ([Time].[1997].[Q1], [Store].[CA].[San Francisco])"</span>);</span><br><span class="line">Result result = connection.execute(query);</span><br><span class="line">result.print(<span class="keyword">new</span> PrintWriter(System.out));</span><br></pre></td></tr></table></figure>
<p>API还将数据库模式呈现为一组对象： 模式， 多维数据集， 维度， 层次结构， 级别， 成员。<br>有关Mondrian API的更多信息，请参阅 javadoc。</p>
<p>用于分析的XML是通过SOAP（简单对象访问协议）访问OLAP服务器的标准。<br>这允许Microsoft Excel等非Java组件针对Mondrian运行查询。</p>
<p><code>蒙德里安</code>包括对 JSR-069(‘JOLAP’)提议标准的支持，<br>但是在明确标准永远不会被批准的情况下，这一支持在mondrian-2.3中被删除。</p>
<p><a href="https://mondrian.pentaho.com/documentation/architecture.php#Figure_1:_Mondrian_architecture" target="_blank" rel="noopener">https://mondrian.pentaho.com/documentation/architecture.php#Figure_1:_Mondrian_architecture</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://linchenguang.com/2018/05/24/Mondrian-architecture/" data-id="cjr4c2nbn00ddu3mvpyo961fq" class="article-share-link">Share</a><div class="tags"><a href="/tags/constructure/">constructure</a><a href="/tags/sql/">sql</a></div><div class="post-nav"><a href="/2018/05/31/WebSocket-protocol/" class="pre">WebSocket protocol</a><a href="/2018/05/22/python-encode/" class="next">python encode</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://linchenguang.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/c/">c++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cryptograpy/">cryptograpy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/db/">db</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/version/">version</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/latex/">latex</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ml/">ml</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/raspberry/">raspberry</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/regex/">regex</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/">search</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/theory/">theory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/version/">version</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/sort/" style="font-size: 15px;">sort</a> <a href="/tags/hello/" style="font-size: 15px;">hello</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/mybatis/" style="font-size: 15px;">mybatis</a> <a href="/tags/yml/" style="font-size: 15px;">yml</a> <a href="/tags/encode/" style="font-size: 15px;">encode</a> <a href="/tags/regex/" style="font-size: 15px;">regex</a> <a href="/tags/collection/" style="font-size: 15px;">collection</a> <a href="/tags/array/" style="font-size: 15px;">array</a> <a href="/tags/compress/" style="font-size: 15px;">compress</a> <a href="/tags/lucene/" style="font-size: 15px;">lucene</a> <a href="/tags/apache/" style="font-size: 15px;">apache</a> <a href="/tags/fundamental/" style="font-size: 15px;">fundamental</a> <a href="/tags/constructure/" style="font-size: 15px;">constructure</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/literal/" style="font-size: 15px;">literal</a> <a href="/tags/ascii/" style="font-size: 15px;">ascii</a> <a href="/tags/anchor/" style="font-size: 15px;">anchor</a> <a href="/tags/syntax/" style="font-size: 15px;">syntax</a> <a href="/tags/guide/" style="font-size: 15px;">guide</a> <a href="/tags/group/" style="font-size: 15px;">group</a> <a href="/tags/keyboard/" style="font-size: 15px;">keyboard</a> <a href="/tags/repetition/" style="font-size: 15px;">repetition</a> <a href="/tags/command/" style="font-size: 15px;">command</a> <a href="/tags/rename/" style="font-size: 15px;">rename</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/difference/" style="font-size: 15px;">difference</a> <a href="/tags/selector/" style="font-size: 15px;">selector</a> <a href="/tags/file/" style="font-size: 15px;">file</a> <a href="/tags/rsa/" style="font-size: 15px;">rsa</a> <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a> <a href="/tags/factor/" style="font-size: 15px;">factor</a> <a href="/tags/inverse/" style="font-size: 15px;">inverse</a> <a href="/tags/math/" style="font-size: 15px;">math</a> <a href="/tags/first/" style="font-size: 15px;">first</a> <a href="/tags/probability/" style="font-size: 15px;">probability</a> <a href="/tags/function/" style="font-size: 15px;">function</a> <a href="/tags/elasticsearch/" style="font-size: 15px;">elasticsearch</a> <a href="/tags/elastic/" style="font-size: 15px;">elastic</a> <a href="/tags/character/" style="font-size: 15px;">character</a> <a href="/tags/proxy/" style="font-size: 15px;">proxy</a> <a href="/tags/pattern/" style="font-size: 15px;">pattern</a> <a href="/tags/freemarker/" style="font-size: 15px;">freemarker</a> <a href="/tags/security/" style="font-size: 15px;">security</a> <a href="/tags/shiro/" style="font-size: 15px;">shiro</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/btree/" style="font-size: 15px;">btree</a> <a href="/tags/hash/" style="font-size: 15px;">hash</a> <a href="/tags/strategy/" style="font-size: 15px;">strategy</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/memcached/" style="font-size: 15px;">memcached</a> <a href="/tags/oracle/" style="font-size: 15px;">oracle</a> <a href="/tags/sql/" style="font-size: 15px;">sql</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/quantum/" style="font-size: 15px;">quantum</a> <a href="/tags/config/" style="font-size: 15px;">config</a> <a href="/tags/thread/" style="font-size: 15px;">thread</a> <a href="/tags/linear/" style="font-size: 15px;">linear</a> <a href="/tags/graph/" style="font-size: 15px;">graph</a> <a href="/tags/computer/" style="font-size: 15px;">computer</a> <a href="/tags/string/" style="font-size: 15px;">string</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/install/" style="font-size: 15px;">install</a> <a href="/tags/kafka/" style="font-size: 15px;">kafka</a> <a href="/tags/solr/" style="font-size: 15px;">solr</a> <a href="/tags/unicode/" style="font-size: 15px;">unicode</a> <a href="/tags/symbol/" style="font-size: 15px;">symbol</a> <a href="/tags/protocol/" style="font-size: 15px;">protocol</a> <a href="/tags/audio/" style="font-size: 15px;">audio</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/29/compile-spring-5-x-in-idea/">compile spring 5.x in idea</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/11/Bayes-theorem/">Bayes' theorem</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/29/thread-pool-anaylsis/">thread pool anaylsis</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/27/troubleshooting-high-cpu-occupancy-rate/">troubleshooting high cpu occupancy rate</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/22/Lucene-fmn-index-output-format/">Lucene fmn index & output type</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/21/download-outside-GFW/">download outside GFW</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/11/Nginx-https-in-aws/">Nginx https in aws</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/11/Regex-in-repository/">Regex in repository</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/26/wireless-raspberry-audio/">wireless raspberry audio</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/20/Vector-group-1/">Vector group (1)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div><ul></ul><a href="http://www.linchenguang.com/sql" title="sql" target="_blank">sql</a><ul></ul><a href="http://www.linchenguang.com/cron" title="cron" target="_blank">cron</a><ul></ul><a href="http://www.linchenguang.com/regex" title="regex" target="_blank">regex</a><ul></ul><a href="http://www.linchenguang.com/keyboard" title="keyboard" target="_blank">keyboard</a><ul></ul><a href="http://www.linchenguang.com/toy" title="toy" target="_blank">toy</a><ul></ul><a href="http://www.linchenguang.com/KaTeX" title="KaTeX" target="_blank">KaTeX</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">BurningBright.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>